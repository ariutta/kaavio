<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: editor/editor-utils.js</title>
    
    
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"kaavio","disqus":"false","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"","description":"","keyword":""},"linenums":false};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">kaavio</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <li class="item" data-name="module.exports~simpleModalComponent">
            <span class="title">
                <a href="module.exports-simpleModalComponent.html">module.exports~simpleModalComponent</a>
                
                <span class="static">static</span>
                
            </span>
            <ul class="members itemMembers">
            
            </ul>
            <ul class="typedefs itemMembers">
            
            </ul>
            <ul class="methods itemMembers">
            
            <span class="subtitle">Methods</span>
            
                <li data-name="module.exports~simpleModalComponent.config"><a href="module.exports-simpleModalComponent.html#config">config</a></li>
            
            </ul>
            <ul class="events itemMembers">
            
            </ul>
        </li>
    
    </ul>
</div>
    <div class="main">
        <h1 class="page-title" data-filename="editor-utils.js.html">Source: editor/editor-utils.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source "><code>var _ = require('lodash');
var highland = require('highland');
var jsonld = require('jsonld');

/**
 * Convert an input into an array, if it is not already.
 *
 * @param {*} arg
 * @return {array} arrayified version on input arg
 */
function arrayify(arg) {
  return _.isArray(arg) ? arg : [arg];
}

/**
 * Convert an input into an array, if it is not already.
 * If the input is falsey but not false or 0, return an empty array.
 *
 * @param {*} arg
 * @return {array} arrayified version on input arg
 */
function arrayifyClean(arg) {
  if (!arg &amp;&amp; arg !== false &amp;&amp; arg !== 0) {
    return [];
  }
  return arrayify(arg);
}

var context = {
  'biopax': {
    '@id': 'http://www.biopax.org/release/biopax-level3.owl#',
    '@type': '@id'
  },
  'bridgedb': 'http://www.example.org/bridgedb/input-vocab/',
  'dcterms': {
    '@id': 'http://purl.org/dc/terms/',
    '@type': '@id'
  },
  'displayName': 'bridgedb:_displayName',
  /* Weird that the above works, but the below does not.
  'displayName': {
    '@id': 'bridgedb:_displayName',
    '@type': '@id'
  },
  //*/
  'gpml': {
    '@id': 'http://vocabularies.wikipathways.org/gpml#',
    '@type': '@id'
  },
  'id': '@id',
  'identifier': {
    '@id': 'http://rdaregistry.info/Elements/u/P60052',
    '@type': '@id'
  },
  'prefLabel': {
    '@id': 'skos:prefLabel',
    '@type': '@id'
  },
  'skos': {
    '@id': 'http://www.w3.org/2004/02/skos/core#',
    '@type': '@id'
  },
  'subject': {
    '@id': 'dcterms:subject',
    '@type': '@id'
  },
  'type': '@type',
};

/**
 * Convert from Biopax-ish entityReference to pvjs annotationEntity.
 *
 * @param {object} entityReference
 * @param {string} entityReference.id || entityReference['@id']
 * @param {string} entityReference.type || entityReference['@type']
 * @param {string} entityReference.displayName || entityReference._displayName
 * @param {string} entityReference.identifier Character string that differentiates this
 *                                          entityReference from other entityReferences.
 * @param {object} entityReference.isDataItemIn Dataset of which this entityReference
 *                                              reference is a member
 * @param {string} entityReference.isDataItemIn.id || entityReference.isDataItemIn['@id'] IRI
 * @param {string} entityReference.isDataItemIn.displayName
 * @param {object} selectedPvjsElement
 * @param {string} selectedPvjsElement.displayName || selectedPvjsElement._displayName
 * @return {object} an annotationEntity, which is a combination of an Xref plus
 *                  the displayName of the selected element, which may differ from
 *                  the displayName of the referenced Xref.
 */
function createAnnotationEntity(entityReference, selectedPvjsElement) {
  var annotationEntity = _.clone(entityReference);
  annotationEntity.displayName = selectedPvjsElement.textContent || annotationEntity.displayName;
  annotationEntity.id = annotationEntity.id || annotationEntity['@id'];

  var gpmlNodeTypes = [{
    '@id': 'http://example.org/',
    name: 'Type'
  }, {
    '@id': 'gpml:GeneProduct',
    name: 'Gene Product'
  }, {
    '@id': 'gpml:Metabolite',
    name: 'Metabolite'
  }, {
    '@id': 'biopax:Pathway',
    name: 'Pathway'
  }, {
    '@id': 'biopax:ProteinReference',
    name: 'Protein'
  }, {
    '@id': 'gpml:Unknown',
    name: 'Unknown'
  }];

  var gpmlDataNodeTypeId;

  // TODO make the way we specify annotationEntity types consistent
  if (!!annotationEntity.type) {
    var gpmlDataNodeTypeBiopaxId = annotationEntity.type;
    var biopaxToHybridMappings = {
      'DnaReference': 'gpml:GeneProduct',
      'ProteinReference': 'biopax:ProteinReference',
      'SmallMoleculeReference': 'gpml:Metabolite',
      'PhysicalEntity': 'gpml:Unknown',
      'Pathway': 'biopax:Pathway'
    };

    gpmlDataNodeTypeId = biopaxToHybridMappings[gpmlDataNodeTypeBiopaxId];
  } else {
    var candidateMatchIds = gpmlNodeTypes.map(function(gpmlNodeType) {
      return gpmlNodeType['@id'];
    });

    gpmlDataNodeTypeId = _.intersection(candidateMatchIds, annotationEntity['@type'])[0];
  }

  annotationEntity.type = gpmlDataNodeTypeId;

  var dataset = annotationEntity.isDataItemIn;
  dataset.id = dataset.id || dataset['@id'];

  return annotationEntity;
}

var createJsonldCompactStream = highland.wrapCallback(jsonld.compact);
var createJsonldExpandStream = highland.wrapCallback(jsonld.expand);

module.exports = {
  arrayify: arrayify,
  arrayifyClean: arrayifyClean,
  context: context,
  createAnnotationEntity: createAnnotationEntity,
  createJsonldCompactStream: createJsonldCompactStream,
  createJsonldExpandStream: createJsonldExpandStream
};
</code></pre>
        </article>
    </section>






        
        <!-- disqus code -->
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <!-- // disqus code -->
        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Mon May 18 2015 21:46:50 GMT-0700 (PDT)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
